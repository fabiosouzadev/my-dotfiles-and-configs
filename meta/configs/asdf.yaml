- shell:
    - description: Remove previous asdf folder
      command: "[ ! -d ~/.asdf ] || sudo rm -rf ~/.asdf"
    - description: Clone asdf
      command: |
        git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.11.3
- link:
    ~/.asdfrc: asdf/asdfrc
    ~/.zshrc.d/018-asdf.zsh: zshrc.d/018-asdf.zsh

- shell:
    - description: Install asdf packages
      command: |
        export PATH="$PATH:$HOME/.asdf/bin"
        echo '. "$HOME/.asdf/asdf.sh"' | tee -a ~/.bashrc > /dev/null
        . "$HOME/.asdf/asdf.sh"
        . ~/.bashrc

        if [ `uname` = 'Linux' ]; then 
          case $(lsb_release -is) in 
            Ubuntu)
              sudo apt-get install -y \
                dirmngr \
                gpg \
                curl \
                gawk
          esac
        fi

    # - description: Install Java
    #   command: |
    #     asdf plugin add java https://github.com/halcyon/asdf-java.git
    #     asdf install java latest

    # - description: Install jq
    #   command: |
    #     $HOME/.asdf/bin/asdf plugin add jq https://github.com/AZMCode/asdf-jq.git
    #     $HOME/.asdf/bin/asdf install jq 1.6
    #     $HOME/.asdf/bin/asdf global jq 1.6
    #   stdout: true

    - description: Install bun
      command: |
        $HOME/.asdf/bin/asdf plugin add bun https://github.com/cometkim/asdf-bun.git
        $HOME/.asdf/bin/asdf install bun latest
        $HOME/.asdf/bin/asdf global bun latest

    - description: Install Flutter
      command: |
        if [ `uname` = 'Darwin' ]; then
          brew install jq
        elif [ `uname` = 'Linux' ]; then 
          case $(lsb_release -is) in 
            Ubuntu)
              sudo apt-get install jq
          esac
        fi
        $HOME/.asdf/bin/asdf plugin-add flutter
        $HOME/.asdf/bin/asdf install flutter 3.7.12-stable
        $HOME/.asdf/bin/asdf global flutter 3.7.12-stable
      stdout: true

    - description: Install Dart
      command: |
        $HOME/.asdf/bin/asdf plugin add dart https://github.com/patoconnor43/asdf-dart.git
        $HOME/.asdf/bin/asdf install dart latest
        $HOME/.asdf/bin/asdf global dart latest

    - description: Install dotnet-core
      command: |
        $HOME/.asdf/bin/asdf plugin add dotnet-core https://github.com/emersonsoares/asdf-dotnet-core.git
        $HOME/.asdf/bin/asdf install dotnet-core latest
        $HOME/.asdf/bin/asdf global dotnet-core latest
      stdout: true
